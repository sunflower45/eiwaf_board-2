/* eiwaf-ui v1.0.0 | Calendar | (c)E4NET Ltd, Co. */
(function(j){var b=false;var i=new Date();var n=i.getFullYear();var c=i.getMonth()+1;var m=i.getDate();var h=n;var d=c;var o=m;var g=null;var f=null;var e="";var k="";var l="";var a="";j.fn.eiwafCal=function(p){p=j.extend({useKeyIn:true,useIconOnly:true,datePattern:"yyyyMMdd",headerType:"N",yearRange:5},p);var q=j(this).filter(":text");if(q.attr("calendarLoaded")=="true"){return}q.attr("calendarLoaded","true");if(c.toString().length<2){c="0"+c;d=c}j("[CalendarTarget=day] span").each(function(){j(this).html("{DAY}")});j("[CalendarTarget=day] td").each(function(){j(this).addClass("{CLASS}")});l=j("[CalendarTarget=day]").html();if(p.useKeyIn==false){q.attr("readonly","readonly")}if(!p.useIconOnly){q.mousedown(function(){if(q.val().length<8){q.val("")}q.eiwafGetPatternDate(p)})}j("input[CalendarIcon]").keydown(function(t){if(t.keyCode==13||t.charCode==13){var s=j(this);if(s.attr("disabled")=="disabled"){return false}if(q.val().length<8){j("#"+s.attr("CalendarIcon")).val("")}a=s.attr("CalendarIcon");s.after(j("#calendar"));j("#"+s.attr("CalendarIcon")).eiwafGetPatternDate(p);return false}});j("input[CalendarIcon]").mousedown(function(){var r=j(this);if(r.attr("disabled")=="disabled"){return false}if(q.val().length<8){j("#"+r.attr("CalendarIcon")).val("")}a=r.attr("CalendarIcon");r.after(j("#calendar"));j("#"+r.attr("CalendarIcon")).eiwafGetPatternDate(p)})};j.fn.eiwafGetPatternDate=function(r){f=j(this);var u=f.position();var t=u.top+f.outerHeight();var s=u.left;g=j("div[Calendar=true]");g.css({top:t,left:s,position:"absolute",display:"block"});k=r.datePattern;if(f.attr("Pattern")!=null&&f.attr("Pattern")!=""){k=f.attr("Pattern")}if(Date.formatValid(f.val(),k).code!="Ok"){e=f.val()}var q=f.val().replace(/[^(0-9)]/gi,"");if(q!=null&&q!=""){h=q.substring(k.indexOf("y"),k.indexOf("y")+4);d=q.substring(k.indexOf("M"),k.indexOf("M")+2);o=q.substring(k.indexOf("d"),k.indexOf("d")+2);if(d.toString().length<2){d="0"+d}}else{h=n;d=c;o=m}var p=j("div[Calendar=true] [CalendarTarget]");p.eiwafMakeHeader(r,h,d);j("[CalendarTarget=day]").html(j(this).eiwafMakeDays());j("[CalendarTarget=day]").eiwafSelectDay();if(!b){j("div[Calendar=true] [CalendarEvent]").each(function(){var x=j(this);var w=null;var y=null;calTatObj=j("[CalendarTarget=day]");w=j("[CalendarTarget=year]");y=j("[CalendarTarget=month]");sCalTatYear=null;sCalTatMonth=null;var v=x.attr("CalendarEvent");if(v=="preYear"){x.click(function(){var z=parseInt(w.html());if(z>1000){w.html(z-1);h=z-1;calTatObj.html(calTatObj.eiwafMakeDays());calTatObj.eiwafSelectDay()}return false})}else{if(v=="nextYear"){x.click(function(){var z=parseInt(w.html());if(z<9999){w.html(z+1);h=z+1;calTatObj.html(calTatObj.eiwafMakeDays());calTatObj.eiwafSelectDay()}return false})}else{if(v=="preMonth"){x.click(function(){var A=null;var z=null;if(r.headerType=="N"){A=parseInt(w.html());z=y.html()}else{A=parseInt(j("[CalendarTarget=s_year] option:selected").val());z=j("[CalendarTarget=s_month] option:selected").val()}if(z.substring(0,1)=="0"){z=parseInt(z.substring(1,2))}else{z=parseInt(z)}if(z==1){if(A>1000){w.html(A-1);y.html("12");h=A-1;d="12";j("[CalendarTarget=s_year] select").val(h).attr("selected","selected");j("[CalendarTarget=s_month] select").val(d).attr("selected","selected")}}else{if(z<=10){y.html("0"+(z-1));d="0"+(z-1);j("[CalendarTarget=s_month] select").val(d).attr("selected","selected")}else{y.html(z-1);d=z-1;j("[CalendarTarget=s_month] select").val(d).attr("selected","selected")}}calTatObj.html(calTatObj.eiwafMakeDays());calTatObj.eiwafSelectDay();return false})}else{if(v=="nextMonth"){x.click(function(){var C=null;var z=null;var A=null;var B=null;if(r.headerType=="N"){C=parseInt(w.html());z=y.html()}else{C=parseInt(j("[CalendarTarget=s_year] option:selected").val());z=j("[CalendarTarget=s_month] option:selected").val()}if(z.substring(0,1)=="0"){z=parseInt(z.substring(1,2))}else{z=parseInt(z)}if(z==12){if(C<9999){w.html(C+1);y.html("01");h=C+1;d="01";j("[CalendarTarget=s_year] select").val(h).attr("selected","selected");j("[CalendarTarget=s_month] select").val(d).attr("selected","selected")}}else{if(z<9){y.html("0"+(z+1));d="0"+(z+1);j("[CalendarTarget=s_month] select").val(d).attr("selected","selected")}else{y.html(z+1);d=z+1;j("[CalendarTarget=s_month] select").val(d).attr("selected","selected")}}calTatObj.html(calTatObj.eiwafMakeDays());calTatObj.eiwafSelectDay();return false})}else{if(v=="close"){x.click(function(){if(f.val()==""){f.val(e)}g.css({display:"none"});return false})}else{if(v=="today"){x.click(function(){h=n;d=c;w.html(h);y.html(d);j("[CalendarTarget=s_year] select").val(h).attr("selected","selected");j("[CalendarTarget=s_month] select").val(d).attr("selected","selected");calTatObj.html(calTatObj.eiwafMakeDays());calTatObj.eiwafSelectDay();return false})}}}}}}});j("[CalendarTarget=s_year] select").change(function(){h=j("[CalendarTarget=s_year] option:selected").text();d=j("[CalendarTarget=s_month] option:selected").text();j("[CalendarTarget=s_year] select").html(j(this).eiwafMakeHeader(r,h,d));j("[CalendarTarget=day]").html(j(this).eiwafMakeDays())});j("[CalendarTarget=s_month] select").change(function(){h=j("[CalendarTarget=s_year] option:selected").text();d=j("[CalendarTarget=s_month] option:selected").text();j("[CalendarTarget=day]").html(j(this).eiwafMakeDays())});b=true}};j.fn.eiwafMakeHeader=function(r,s,u){var v=parseInt(s);var q=parseInt(u);if(r.headerType=="N"){j("[CalendarHead=N]").css({display:"block"});j("[CalendarTarget=year]").html(s);j("[CalendarTarget=month]").html(u)}else{j("[CalendarHead=S]").css({display:"block"});j("[CalendarHead] option").remove();for(var p=v-r.yearRange;p<=v+r.yearRange;p++){j("[CalendarTarget=s_year] select").append("<option value='"+p+"'"+(p==v?' selected="selected"':"")+">"+p+"</option>")}for(var t=0;t<12;t++){var u=t+1;if(u.toString().length<2){u="0"+u}j("[CalendarTarget=s_month] select").append("<option value='"+u+"'"+(u==q?' selected="selected"':"")+">"+u+"</option>")}}};j.fn.eiwafMakeDays=function(){var w=1;var p=1;var x="";var u="";var r=new Date();var s=d;if(d.toString().indexOf(0)=="0"){s=d.substring(1,2)}r.setDate(1);r.setMonth(s-1);r.setFullYear(h);var q=r.getDay();var v=Date.daysInMonth(r);for(var t=0;t<6;t++){x=l;x=x.replace("today","");while(x.indexOf("{DAY}")!=-1){if(p>q&&w<=v){x=x.replace("{DAY}",w);if(o==null){if(m==w){x=x.replace("{CLASS}","today")}}else{if(o==w){x=x.replace("{CLASS}","today")}}x=x.replace("{CLASS}","");w++}else{x=x.replace("{DAY}","");x=x.replace("{CLASS}","");p++}}u+=x;if(w>v){break}}return u};j.fn.eiwafSelectDay=function(){j("[CalendarTarget=day] tr td").click(function(){var p=j(this).find("span").html();if(p==""){return false}if(p.toString().length<2){p="0"+p}var q=k.toLowerCase().replace("yyyy",h).replace("mm",d).replace("dd",p);f.val(q);f.blur();g.css({display:"none"});j("input[CalendarIcon="+a+"]").focus();return false})};j.fn.disabledCal=function(){j("div[Calendar=true]").css({display:"none"});return this.each(function(){var p=j(this);p.attr("disabled","disabled");j("input[CalendarIcon="+p.attr("id")+"]").attr("disabled","disabled")})};j.fn.enabledCal=function(){j("div[Calendar=true]").css({display:"none"});return this.each(function(){var p=j(this);p.removeAttr("disabled");j("input[CalendarIcon="+p.attr("id")+"]").removeAttr("disabled")})}})(jQuery);